<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>简单地编写一个Scratch扩展</title>
    <link href="/2025/03/09/How-to-write-a-Scratch-extension/"/>
    <url>/2025/03/09/How-to-write-a-Scratch-extension/</url>
    
    <content type="html"><![CDATA[<blockquote><p>随着<strong>图形化编程</strong>的兴起，比如 <strong>Scratch</strong>、<strong>编程猫</strong>和 Mind+ 等等变得越来越受欢迎。同时，像 Scratch 原有的内容已经不足以给各位提供足够的函数了。像 <strong><a href="https://turbowarp.org/">TurboWarp</a></strong>、<strong><a href="https://ccw.site/gandi">Gandi IDE</a></strong>、Scratch Lab、Scratch X 等就提供了丰富的非原版函数库(即扩展，mod)。比如，你可以访问 <a href="https://extension.turbowarp.org/">TurboWarp扩展库</a> 来查看 TurboWarp 为 Scratchers 提供的扩展。扩展和其他编程语言的“库函数”相似，都是添加原来没有的函数内容。如果你认为这些内容还不够你用，那你就得自己写了。怎么写呢？接下来就听我娓娓道来！</p></blockquote><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>很显然，你需要一个好用的<strong>文本编辑器</strong>(比如 VSCode、Notepad++等，当然，你直接用记事本也可以)、一个可以加载自定义扩展的 Scratch Mod (比如 <a href="https://turbowarp.org/editor">TurboWarp</a>、<a href="https://www.ccw.site/gandi/extension">Gandi IDE 扩展模式</a>等)、以及一些 JavaScript 基础。</p><p>如果你自恃拥有强大的编程能力和足够的英语基础，你可以前往 <a href="https://docs.turbowarp.org/development">TurboWarp 扩展文档</a> 查看更官方更权威的扩展教程。</p><h2 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h2><p>首先，我将为你展示 Scratch 扩展文件的基本结构：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">(<span class="hljs-keyword">function</span> (<span class="hljs-params">Scratch</span>) &#123;<br>    <span class="hljs-string">&quot;use strict&quot;</span>;<br><br>    <span class="hljs-title class_">Scratch</span>.<span class="hljs-property">translate</span>.<span class="hljs-title function_">setup</span>(&#123;...&#125;);<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExtName</span> &#123;<br>        <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">id</span>: ...<br>                <span class="hljs-attr">name</span>: ...<br>                ...<br>            &#125;;<br>        &#125;<br><br>        <span class="hljs-title class_">Function</span>(arg) &#123;...&#125;<br>    &#125;<br><br>    <span class="hljs-title class_">Scratch</span>.<span class="hljs-property">extensions</span>.<span class="hljs-title function_">register</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ExtName</span>());<br>&#125;)(<span class="hljs-title class_">Scratch</span>);<br></code></pre></td></tr></table></figure><p>如上，这就是最基本的 Scratch 扩展格式。其中，<code>Scratch.translate.setup()</code>为你的扩展提供了 l10n (本地化)支持，可以提供这个函数来设置多语言。之后就是定义一个类了，这个类当中包含了你的扩展的信息(<code>getInfo</code>)和函数定义。最后，通过<code>Scratch.extensions.register()</code>函数来注册这个扩展。</p><p>接下来，让我们慢慢讲具体的内容~</p><h2 id="Scratch-translate-setup-l10n-支持"><a href="#Scratch-translate-setup-l10n-支持" class="headerlink" title="Scratch.translate.setup() l10n 支持"></a><code>Scratch.translate.setup()</code> l10n 支持</h2><p>在 Scratch 扩展中，<code>Scratch.translate.setup()</code>的语法如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-title class_">Scratch</span>.<span class="hljs-property">translate</span>.<span class="hljs-title function_">setup</span>(&#123;<br>    <span class="hljs-string">&quot;en&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;_key&quot;</span>: <span class="hljs-string">&quot;translation&quot;</span>,<br>        ...<br>    &#125;,<br>    <span class="hljs-string">&quot;zh-cn&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;_key&quot;</span>: <span class="hljs-string">&quot;翻译&quot;</span>,<br>        ...<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>给这个函数提供一个 JSON 参数，在之后重新调用<code>Scratch.translate()</code>函数就可以将<code>key</code>字符串自动转换为对应的值(也就是翻译内容)。比如，我在上面设置了<code>&quot;_key&quot;</code>对应的值是<code>&quot;翻译&quot;</code>，那么，当我的编辑器语言为简体中文<code>(zh-cn)</code>的时候，<code>Scratch.translate(&quot;key&quot;)</code>就会返回<code>&quot;翻译&quot;</code>。</p><p>这是由 Scratch 本身提供的翻译功能，善用它会取得不错的成效。</p><h2 id="getInfo-给你的扩展编写信息"><a href="#getInfo-给你的扩展编写信息" class="headerlink" title="getInfo() 给你的扩展编写信息"></a><code>getInfo()</code> 给你的扩展编写信息</h2><p>在<code>getInfo()</code>函数中，你应该为其定义编写一堆内容，包括了<code>扩展ID</code>，<code>扩展名</code>，<code>扩展积木颜色</code>，<code>扩展积木</code>等等。接下来我会给出一个简单的 getInfo() 示例，它可以创建一个 COMMAND 块：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-title function_">getInfo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;SampleExt&quot;</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;示例扩展&quot;</span>,<br>        <span class="hljs-attr">color1</span>: <span class="hljs-string">&quot;#66ccff&quot;</span>,<br>        <span class="hljs-attr">blocks</span>: [<br>            &#123;<br>                <span class="hljs-attr">opcode</span>: <span class="hljs-string">&quot;SampleBlock&quot;</span>,<br>                <span class="hljs-attr">blockType</span>: <span class="hljs-title class_">Scratch</span>.<span class="hljs-property">BlockType</span>.<span class="hljs-property">COMMAND</span>,<br>                <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;示例积木&quot;</span><br>            &#125;<br>        ]<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>如上，在<code>getInfo()</code>的定义中，你会看到一些键值对，比如<code>id</code>、<code>name</code>、<code>color1</code>等等。其中，<code>block</code>后面对应的 Array 中，就是对扩展积木的定义。在这里，我定义了一个 COMMAND 块，上面显示的内容是“示例积木”，它的操作码(<code>opcode</code>)是”SampleBlock”。</p><p>操作码是最重要的一个键，因为它对应了后面对这个块相应的函数的定义。假如我要为这个块编写代码，我就应该在后面定义一个<code>SampleBlock()</code>函数，Scratch 在尝试将这些代码块释放到 <code>Scratch 虚拟机</code> 中的时候，会找到对应操作码的函数，绑定在块上，以便在编辑器中执行。</p><p>在定义一个块的时候，你可以使用一下内容：</p><table><thead><tr><th align="center"></th><th align="center">类型</th><th align="center">介绍</th></tr></thead><tbody><tr><td align="center">opcode</td><td align="center">string</td><td align="center">该块运行时应该运行的函数的名称。例如，如果这是“Sample”，那么将运行类的“Sample”方法。每个扩展中的每个操作码必须是唯一的，因此多个扩展可以每个都有一个操作码为“Sample”的块</td></tr><tr><td align="center">blockType</td><td align="center">Scratch.BlockType.*</td><td align="center">用来决定块的形状，具体见下面一节</td></tr><tr><td align="center">text</td><td align="center">string</td><td align="center">将出现在块编辑器中的文本。当然，这里可能会出现一些特殊的语法，这将在后面讨论</td></tr><tr><td align="center">arguments</td><td align="center">object</td><td align="center">块中可输入的内容。是可选内容，同样在后面讨论</td></tr></tbody></table><h2 id="BlockType-块的类型"><a href="#BlockType-块的类型" class="headerlink" title="BlockType 块的类型"></a><code>BlockType</code> 块的类型</h2><p>玩多了 Scratch ，你应该知道，在 Scratch 中，有很多种不同的块，有像拼图一样的，有圆圆的，有六边形的，也有帽子形状的，还有像个嘴巴一样的 C 的形状的。这就是不同的积木类型，在定义它们的时候，需要根据需求设置它们的类型，接下来我将介绍三个最常见的块类型：</p><h3 id="COMMAND-块"><a href="#COMMAND-块" class="headerlink" title="COMMAND 块"></a>COMMAND 块</h3><p>你应该注意到了，在上一个小节中，我说的是<code>创建一个 COMMAND 块</code>，那什么是 COMMAND 块呢？COMMAND 的意思是指令，命令，也就是说，这个块将执行一个函数，但是不返回内容。所以它在 Scratch 中，就是那种拼图形状的块了。</p><h3 id="REPORTER-块"><a href="#REPORTER-块" class="headerlink" title="REPORTER 块"></a>REPORTER 块</h3><p>我们在使用一些获取值的块的时候，它们通常是圆圆的，比如变量块。这就是 REPORTER 块，它们可以返回函数在运行之后返回的值给 Scratch 编辑器。</p><h3 id="BOOLEN-块"><a href="#BOOLEN-块" class="headerlink" title="BOOLEN 块"></a>BOOLEN 块</h3><p>当然，我们也会遇到一些判断相关的块，它们返回一个布尔值，要么真要么假。这就是 BOOLEN 块，它和 REPORTER 块很像，都可以返回函数的返回值。虽然口头上说的是返回布尔值，但是它们实际上是可以返回其他类型的值的。</p><p>帽子块和C型块将在后面介绍。</p><h2 id="编写函数"><a href="#编写函数" class="headerlink" title="编写函数"></a>编写函数</h2><p>现在，我为你提供一个最简单的扩展示例，这是在 TurboWarp 扩展文档上抄来的，它会返回一个随机数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">random</span> &#123;<br>  <span class="hljs-title function_">getInfo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;random&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;我去 随机数！&#x27;</span>,<br>      <span class="hljs-attr">blocks</span>: [<br>        &#123;<br>          <span class="hljs-attr">opcode</span>: <span class="hljs-string">&#x27;random&#x27;</span>,<br>          <span class="hljs-attr">blockType</span>: <span class="hljs-title class_">Scratch</span>.<span class="hljs-property">BlockType</span>.<span class="hljs-property">REPORTER</span>,<br>          <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;随机数&#x27;</span><br>        &#125;<br>      ]<br>    &#125;;<br>  &#125;<br><br>  <span class="hljs-title function_">random</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-title class_">Scratch</span>.<span class="hljs-property">extensions</span>.<span class="hljs-title function_">register</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">random</span>());<br></code></pre></td></tr></table></figure><p>在这里，我定义了一个操作码为 <code>random</code> 的 <code>REPORTER</code> 块，上面显示的文本为 <code>随机数</code> ，之后，根据操作码 <code>random</code> 我在后面定义了一个 <code>random()</code> 函数，并返回一个随机数。这个随机数将会返回到你的 Scratch 编辑器中，你可以在 TurboWarp 加载这个扩展试试。</p>]]></content>
    
    
    <categories>
      
      <category>Scratch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Scratch</tag>
      
      <tag>Primer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>光辉岁月</title>
    <link href="/2025/03/02/%E5%85%89%E8%BE%89%E5%B2%81%E6%9C%88/"/>
    <url>/2025/03/02/%E5%85%89%E8%BE%89%E5%B2%81%E6%9C%88/</url>
    
    <content type="html"><![CDATA[<p>晚饭的时间，我在夕阳下走向小卖部，要去买点东西吃。</p><p>作业已然成为了生活的重担，我并没有什么心情去看这夕阳下的风光，只是静默地走过了整个操场。</p><p>我买了吃的，走出了商店，在稀疏的人群中。我抬起头喝水，看到了这样的一幕：几个老师和学生在一块打球，另一个场是几个男孩的激烈战场。羽毛球场已然是热血沸腾，乒乓球上的招式也所谓眼花缭乱。走几步，一大群人在足球场上听教练的指导、练习。</p><p>好像夕阳就是这么为他们而出现的。我把盖子拧上，走到了林荫道上。走在人群中间，我听到有人在谈论作业，有人在八卦。在六艺楼，也有人在弹钢琴。乐声悠扬传来，纵使我不知道弹了什么。</p><p>好像夕阳就是这么为他们而出现的。我捏了捏手上的维生素C片。我摇出了响声。但我并没有止住回去的脚步。夕阳是不属于我的。我的眼中是黑夜，无尽的黑夜。但是夕阳着实给了他们光辉岁月。这是属于他们的。</p><p>就像我在桌前急书一样，这是属于我的光辉岁月。</p><div style="text-align:right"><p>玖月壹拾肆日<br>作于B中 </p></div>]]></content>
    
    
    
    <tags>
      
      <tag>article</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
